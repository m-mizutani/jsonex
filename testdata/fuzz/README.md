# Fuzzing Test Data

This directory contains fuzzing corpus files generated by Go's native fuzzing framework.

## Directory Structure

- `FuzzUnmarshal/` - Corpus for the Unmarshal function fuzzing
- `FuzzDecoder/` - Corpus for the Decoder function fuzzing  
- `FuzzUnicodeHandling/` - Corpus for Unicode handling fuzzing
- `FuzzDeepNesting/` - Corpus for deep nesting structure fuzzing

## How it Works

When you run fuzzing tests with `go test -fuzz=FuzzXXX`, Go automatically:

1. **Starts with seed corpus**: Uses the initial test cases provided in `f.Add()` calls
2. **Generates new inputs**: Creates variations and mutations of existing inputs
3. **Saves interesting cases**: Stores inputs that increase code coverage in these directories
4. **Reuses saved cases**: On subsequent runs, starts with all previously discovered cases

## Managing Corpus Files

### Viewing corpus files
```bash
# List all corpus files
find testdata/fuzz -name "*.txt" -type f

# View a specific corpus file
cat testdata/fuzz/FuzzUnmarshal/some-hash.txt
```

### Cleaning corpus files
```bash
# Clean all corpus files
task fuzz:clean

# Or manually
rm -rf testdata/fuzz/*/
```

### Adding manual seed cases
You can manually add test cases by creating files in the appropriate directories:

```bash
# Example: Add a manual test case for FuzzUnmarshal
echo 'go test fuzz v1
[]byte("{\"manual\": \"test case\"}")' > testdata/fuzz/FuzzUnmarshal/manual-case
```

## Best Practices

1. **Commit interesting cases**: Consider committing valuable corpus files that represent important edge cases
2. **Regular cleanup**: Periodically clean up corpus files to prevent excessive growth
3. **Review failures**: When fuzzing finds issues, examine the failing inputs in these directories
4. **Backup important cases**: Archive corpus files that reveal important bugs before cleaning

## CI Integration

The GitHub Actions workflow automatically:
- Creates this directory structure during CI runs
- Archives corpus files as artifacts after fuzzing runs
- Stores artifacts for 30 days for investigation

## File Format

Corpus files follow Go's fuzzing format:
```
go test fuzz v1
<input1>
<input2>
...
```

Each line after the header represents one input parameter to the fuzz function.